.. _README:

======
README
======

The Mindboggle package enables a user to automate anatomical labeling,
feature extraction, and shape analysis of human brain MR image data.

Help
====
- `Online documentation <http://mindboggle.info/documentation.html>`_
- `Installation instructions <INSTALL.html>`_
- Help on the command line::

    $ mindboggle --help

- `Contributor list <THANKS.html>`_

License
=======
Except where noted, all Mindboggle software is under the `Apache v2.0`_
license, and documentation is under a `Creative Commons Attribution 3.0 License`_.

Inputs
======
Mindboggle currently uses output from FreeSurfer v5.3 and the newest ANTs
software packages.
FreeSurfer provides labeled cortical surface meshes and subcortical volumes
as well as white and gray matter segmentation.
ANTS provides brain extraction, segmentation, and registration-based labeling.

To prepare inputs for Mindboggle, run FreeSurfer_ on each T1-weighted IMAGE file
and set the SUBJECT name on the command line
(replace capitalized text below when typing in a terminal window)::

    $ recon-all -all -s SUBJECT -i IMAGE

To run the antsCorticalThickness.sh script in ANTs on the same IMAGE file,
set an output PREFIX, set "-k 1" (to save registration transforms),
and provide paths to OASIS-30 template files (backslashes denote line returns)::

    $ antsCorticalThickness.sh -d 3 \
      -a IMAGE \
      -e OASIS-30_Atropos_template/T_template0.nii.gz \
      -m OASIS-30_Atropos_template/T_template0ProbabilityMask.nii.gz \
      -p OASIS-30_Atropos_template/Priors2/priors%d.nii.gz \
      -f OASIS-30_Atropos_template/T_template0ExtractionMask.nii.gz \
      -k 1 \
      -o PREFIX \
      -w 0.25 \
      -n 3

Examples
========
Terminal command for processing (on 4 processors) multiple subjects with only FreeSurfer data::

    $ mindboggle SUBJECT1 SUBJECT2 SUBJECT3 -n 4

Example using ANTs data (with PREFIX for files in folder ~/ants_data)::

    $ mindboggle SUBJECT1 SUBJECT2 SUBJECT3 --ants_data ~/ants_output PREFIX

Example using most of the currently available options within Mindboggle::

    $ mindboggle SUBJECT1 SUBJECT2 SUBJECT3 --ants_data ~/ants_output PREFIX \
                 --sulci --fundi --vertices --spectra 10 --thickness --visual hier

Outputs
=======
By default, all atlas and template data retrieved via the Internet
as well as Nipype workflow files are saved in $HOME/mindboggle_cache/,
and final outputs are saved in $HOME/mindboggled/
(where $HOME is the home directory).
Nifti_ image volumes (.nii.gz) store anatomical labels as numbers
listed in the mindboggle/LABELS.py file and `online <http://mindboggle.info/data/mindboggle101/protocol.txt>`_, and
all left and right cortical surface (.vtk) vertices are number-labeled
by anatomical label, feature, or shape measure. Shape measure statistics
are stored in tables (.csv).

+-+---------------+----------------------------------------------+--------------+
| |  **Folder**   | **Contents**                                 | **Format**   |
+-+---------------+----------------------------------------------+--------------+
| |   labels/     |  number-labeled surfaces and volumes         | .vtk, .nii.gz|
+-+---------------+----------------------------------------------+--------------+
| |   features/   |  surface features: folds, sulci, fundi       | .vtk         |
+-+---------------+----------------------------------------------+--------------+
| |   shapes/     |  surfaces with shape measures (per vertex)   | .vtk         |
+-+---------------+----------------------------------------------+--------------+
| |   tables/     |  tables of shape measures per label/feature  | .csv         |
+-+---------------+----------------------------------------------+--------------+

**mindboggled /**

    *Volume labels:*

    **labels** / SUBJECT /

        **cortex_and_noncortex**.nii.gz:    *brain segmented into cortex=2 and noncortex=3*

        **ANTs_registered_labels**.nii.gz:    *atlas labels registered to subject with ANTs*

        **ANTs_filled_labels**.nii.gz:    *non/cortex separately filled with ANTs labels*

        **FreeSurfer_filled_labels**.nii.gz:    *non/cortex separately filled with FreeSurfer labels*

    *FreeSurfer-based surface labels:*

    **labels** / [left,right]_surface / SUBJECT /

        **FreeSurfer_cortex_labels**.vtk:    *DKT40 classifier surface labels*

        **FreeSurfer_cortex_volume_labels**.vtk:    *surface with volume labels (left=1000+; right=2000+)*

    *Features extracted from cortical surface meshes:*

    **features** / [left,right]_surface / SUBJECT /

        **folds**.vtk:    *depth-based cortical surface folds (invaginations)*

        **sulci**.vtk:    *folds segmented into sulci using label pairs*

        **fundus_per_fold**.vtk:    *curves running along depths of folds*

        **fundus_per_sulcus**.vtk:    *fundus curves segmented by sulcus labels*

    *Per-vertex surface shape measures:*

    **shapes** / [left,right]_surface / SUBJECT /

        **area**.vtk

        **mean_curvature**.vtk

        **geodesic_depth**.vtk

        **travel_depth**.vtk

        **FreeSurfer_convexity**.vtk:    *FreeSurfer's [lh,rh].sulc files*

        **FreeSurfer_thickness**.vtk:    *FreeSurfer's [lh,rh].thickness files*

    *Tables with per-feature surface shape statistics:*

    **tables** / [left,right]_surface / SUBJECT /

        **label_shapes**.csv

        **sulcus_shapes**.csv

        **fundus_shapes**.csv

        **vertices**.csv:    *(exception: per-vertex shape measures)*

    *Tables with per-label volumes and thicknesses:*

    **tables** / SUBJECT /

        **ANTs_filled_labels_volumes**.csv

        **ANTs_filled_labels_volumes_areas_thicknesses**.csv

        **FreeSurfer_filled_labels_volumes**.csv

        **FreeSurfer_filled_labels_volumes_areas_thicknesses**.csv

The shape tables above contain a subset of the following measures:

    - Surface area
    - Travel depth
    - Geodesic depth
    - Mean curvature
    - Convexity (FreeSurfer)
    - Thickness (FreeSurfer)
    - Laplace-Beltrami spectra (per feature)
    - Zernike moments (per feature)
    - Volume and thickness

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Mindboggle &mdash; Mindboggle</title>
    
    <link rel="stylesheet" href="../../_static/mindboggle.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../',
        VERSION:     '%s.%s.%s%s',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <link rel="top" title="Mindboggle" href="../../index.html" />
  <HTML><head><title>Mindboggle</title>
  <link rel="icon" type="image/png" sizes="96x96" href="http://mindboggle.info/shared/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="32x32" href="http://mindboggle.info/shared/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="http://mindboggle.info/shared/favicon-16x16.png">
  <meta http-equiv="Content-language" content="en">
  <meta name="description" content="Mindboggle">
  <meta name="keywords" content="Mindboggle, neuroimaging, brain imaging, python, neuroscience, labeling, parcellation, morphometry, shape analysis, MRI">
  <meta name="author" content="mailto:arno&#64;mindboggle.info">
  <meta name="dc.title" content="Mindboggle"> 
  <meta name="dc.creator.address" content="arno&#64;mindboggle.info">
  <meta name="dc.subject" content="Mindboggle">
  <meta name="dc.type" content="text.homepage.academic"> 
  <meta name="dc.format" content="text/html"> 
  <meta name="dc.identifier" content="http://mindboggle.info">

  </head>
  <body role="document">
<div style="background-color: white; text-align: left; padding: 10px 10px 15px 15px">
 <table>
  <tr>
   <td>

 <a href="../../index.html">
  <img src="http://nipy.github.io/mindboggle/shared/mindboggle_logo_small.jpg" alt="small mindboggle logo"  border="0" width="160"/></a>

   </td>
   <td>
    <table>
     <tr>
 <a style="padding: 20px 20px 20px 20px; color: #b07613; text-decoration: none; font-size: 32px"
  href="../../index.html">Mindboggle</a>
     </tr>
     <tr> <td height="18"></td>
     </tr>
     <tr>
      <td>
  <a style="padding: 20px 20px 20px 20px; text-decoration: none; font-size: 18px"
   href="http://nipy.github.io/mindboggle/users/README.html">Software</a>
      </td>
      <td>
  <a style="padding: 20px 20px 20px 20px; text-decoration: none; font-size: 18px"
   href="../../data.html">Data</a>
      </td>
      <td>
  <a style="padding: 20px 20px 20px 20px; text-decoration: none; font-size: 18px"
   href="../../papers.html">Papers</a>
      </td>
      <td>
  <a style="padding: 20px 20px 20px 20px; text-decoration: none; font-size: 18px"
   href="../../people.html">People</a>
      </td>
     </tr>
    </table>
   </td>
  </tr>
 </table>
</div>
  

    <div class="document">
      <div class="documentwrapper">
          <div class="body" role="main">
            
  <div class="section" id="shapes-volume-shapes">
<h1>shapes.volume_shapes<a class="headerlink" href="#shapes-volume-shapes" title="Permalink to this headline">¶</a></h1>
<div class="section" id="module-mindboggle.shapes.volume_shapes">
<span id="module-shapes-volume-shapes"></span><h2>Module: <code class="xref py py-mod docutils literal"><span class="pre">shapes.volume_shapes</span></code><a class="headerlink" href="#module-mindboggle.shapes.volume_shapes" title="Permalink to this headline">¶</a></h2>
<p>Compute shape measures from volume images.</p>
<dl class="docutils">
<dt>Authors:</dt>
<dd><ul class="first last simple">
<li>Arno Klein, 2013-2015  (<a class="reference external" href="mailto:arno&#37;&#52;&#48;mindboggle&#46;info">arno<span>&#64;</span>mindboggle<span>&#46;</span>info</a>)  <a class="reference external" href="http://binarybottle.com">http://binarybottle.com</a></li>
</ul>
</dd>
</dl>
<p>Copyright 2015,  Mindboggle team (<a class="reference external" href="http://mindboggle.info">http://mindboggle.info</a>), Apache v2.0 License</p>
</div>
<div class="section" id="functions">
<h2>Functions<a class="headerlink" href="#functions" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="mindboggle.shapes.volume_shapes.thickinthehead">
<code class="descclassname">mindboggle.shapes.volume_shapes.</code><code class="descname">thickinthehead</code><span class="sig-paren">(</span><em>segmented_file</em>, <em>labeled_file</em>, <em>cortex_value=2</em>, <em>noncortex_value=3</em>, <em>labels=[]</em>, <em>names=[]</em>, <em>resize=True</em>, <em>propagate=True</em>, <em>output_dir=''</em>, <em>save_table=False</em>, <em>output_table=''</em><span class="sig-paren">)</span><a class="headerlink" href="#mindboggle.shapes.volume_shapes.thickinthehead" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute a simple thickness measure for each labeled cortex region volume.</p>
<p>Note:</p>
<div class="highlight-python"><div class="highlight"><pre>- Cortex, noncortex, &amp; label files are from the same coregistered brain.
- Calls ANTs functions: ImageMath, Threshold, ResampleImageBySpacing
- There may be slight discrepancies between volumes computed by
  thickinthehead() and volumes computed by volume_for_each_label();
  in 31 of 600+ ADNI 1.5T images, some volume_for_each_label() volumes
  were slightly larger (in the third decimal place), presumably due to
  label propagation through the cortex in thickinthehead().
  This is more pronounced in ANTs vs. FreeSurfer-labeled volumes.
</pre></div>
</div>
<p>Example preprocessing steps</p>
<div class="highlight-python"><div class="highlight"><pre>1. Run Freesurfer and antsCorticalThickness.sh on T1-weighted image.
2. Convert FreeSurfer volume labels (e.g., wmparc.mgz or aparc+aseg.mgz)
   to cortex (2) and noncortex (3) segments using relabel_volume()
   function [refer to LABELS.rst or FreeSurferColorLUT labels file].
3. Convert ANTs Atropos-segmented volume (tmpBrainSegmentation.nii.gz)
   to cortex and noncortex segments, by converting 1-labels to 0 and
   4-labels to 3 with the relabel_volume() function
   (the latter is to include deep-gray matter with noncortical tissues).
4. Combine FreeSurfer and ANTs segmentation volumes to obtain a single
   cortex (2) and noncortex (3) segmentation file using the function
   combine_2labels_in_2volumes(). This function takes the union of
   cortex voxels from the segmentations, the union of the noncortex
   voxels from the segmentations, and overwrites intersecting cortex
   and noncortex voxels with noncortex (3) labels.
   ANTs tends to include more cortical gray matter at the periphery of
   the brain than Freesurfer, and FreeSurfer tends to include more white
   matter that extends deep into gyral folds than ANTs, so the above
   attempts to remedy their differences by overlaying ANTs cortical gray
   with FreeSurfer white matter.
5. Optional, see Step 2 below:
   Fill segmented cortex with cortex labels and noncortex with
   noncortex labels using the PropagateLabelsThroughMask() function
   (which calls ImageMath ... PropagateLabelsThroughMask in ANTs).
   The labels can be initialized using FreeSurfer (e.g. wmparc.mgz)
   or ANTs (by applying the nonlinear inverse transform generated by
   antsCorticalThickness.sh to labels in the Atropos template space).
   [Note: Any further labeling steps may be applied, such as
   overwriting cerebrum with intersecting cerebellum labels.]
</pre></div>
</div>
<p>Steps</p>
<div class="highlight-python"><div class="highlight"><pre>1. Extract noncortex and cortex.
2. Either mask labels with cortex or fill cortex with labels.
3. Resample cortex and noncortex files from 1x1x1 to 0.5x0.5x0.5
   to better represent the contours of the boundaries of the cortex.
4. Extract outer and inner boundary voxels of the cortex,
   by eroding 1 (resampled) voxel for cortex voxels (2) bordering
   the outside of the brain (0) and bordering noncortex (3).
5. Estimate middle cortical surface area by the average volume
   of the outer and inner boundary voxels of the cortex.
6. Compute the volume of a labeled region of cortex.
7. Estimate the thickness of the labeled cortical region as the
   volume of the labeled region (#6) divided by the surface area (#5).
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>segmented_file</strong> : string</p>
<blockquote>
<div><p>image volume with cortex and noncortex (and any other) labels</p>
</div></blockquote>
<p><strong>labeled_file</strong> : string</p>
<blockquote>
<div><p>corresponding image volume with index labels</p>
</div></blockquote>
<p><strong>cortex_value</strong> : integer</p>
<blockquote>
<div><p>cortex label value in segmented_file</p>
</div></blockquote>
<p><strong>noncortex_value</strong> : integer</p>
<blockquote>
<div><p>noncortex label value in segmented_file</p>
</div></blockquote>
<p><strong>labels</strong> : list of integers</p>
<blockquote>
<div><p>label indices</p>
</div></blockquote>
<p><strong>names</strong> : list of strings</p>
<blockquote>
<div><p>label names</p>
</div></blockquote>
<p><strong>resize</strong> : Boolean</p>
<blockquote>
<div><p>resize (2x) segmented_file for more accurate thickness estimates?</p>
</div></blockquote>
<p><strong>propagate</strong> : Boolean</p>
<blockquote>
<div><p>propagate labels through cortex?</p>
</div></blockquote>
<p><strong>output_dir</strong> : string</p>
<blockquote>
<div><p>output directory</p>
</div></blockquote>
<p><strong>save_table</strong> : Boolean</p>
<blockquote>
<div><p>save output table file with label volumes and thickness values?</p>
</div></blockquote>
<p><strong>output_table</strong> : string</p>
<blockquote>
<div><p>name of output table file with label volumes and thickness values</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>label_volume_thickness</strong> : list of lists of integers and floats</p>
<blockquote>
<div><p>label indices, volumes, and thickness values (default -1)</p>
</div></blockquote>
<p><strong>output_table</strong> : string</p>
<blockquote class="last">
<div><p>name of output table file with label volumes and thickness values</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">mindboggle.shapes.volume_shapes</span> <span class="kn">import</span> <span class="n">thickinthehead</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">segmented_file</span> <span class="o">=</span> <span class="s">&#39;/Users/arno/Data/antsCorticalThickness/OASIS-TRT-20-1/antsBrainSegmentation.nii.gz&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">labeled_file</span> <span class="o">=</span> <span class="s">&#39;/appsdir/freesurfer/subjects/OASIS-TRT-20-1/mri/labels.DKT31.manual.nii.gz&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cortex_value</span> <span class="o">=</span> <span class="mi">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">noncortex_value</span> <span class="o">=</span> <span class="mi">3</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c">#labels = [2]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">labels</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1002</span><span class="p">,</span><span class="mi">1036</span><span class="p">)</span> <span class="o">+</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2002</span><span class="p">,</span><span class="mi">2036</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">labels</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="mi">1004</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">labels</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="mi">2004</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">labels</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="mi">1032</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">labels</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="mi">2032</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">labels</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="mi">1033</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">labels</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="mi">2033</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">names</span> <span class="o">=</span> <span class="p">[]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">resize</span> <span class="o">=</span> <span class="bp">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">propagate</span> <span class="o">=</span> <span class="bp">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">output_dir</span> <span class="o">=</span> <span class="s">&#39;&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">save_table</span> <span class="o">=</span> <span class="bp">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">output_table</span> <span class="o">=</span> <span class="s">&#39;&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">label_volume_thickness</span><span class="p">,</span> <span class="n">output_table</span> <span class="o">=</span> <span class="n">thickinthehead</span><span class="p">(</span><span class="n">segmented_file</span><span class="p">,</span> <span class="n">labeled_file</span><span class="p">,</span> <span class="n">cortex_value</span><span class="p">,</span> <span class="n">noncortex_value</span><span class="p">,</span> <span class="n">labels</span><span class="p">,</span> <span class="n">names</span><span class="p">,</span> <span class="n">resize</span><span class="p">,</span> <span class="n">propagate</span><span class="p">,</span> <span class="n">output_dir</span><span class="p">,</span> <span class="n">save_table</span><span class="p">,</span> <span class="n">output_table</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="mindboggle.shapes.volume_shapes.volume_per_brain_region">
<code class="descclassname">mindboggle.shapes.volume_shapes.</code><code class="descname">volume_per_brain_region</code><span class="sig-paren">(</span><em>input_file</em>, <em>include_labels=[]</em>, <em>exclude_labels=[]</em>, <em>label_names=[]</em>, <em>save_table=False</em>, <em>output_table=''</em><span class="sig-paren">)</span><a class="headerlink" href="#mindboggle.shapes.volume_shapes.volume_per_brain_region" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute volume per labeled region in a nibabel-readable image.</p>
<p>Note: Results are truncated at three decimal places because we found that
volume label propagation led to differences in the third decimal place.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>input_file</strong> : string</p>
<blockquote>
<div><p>name of image file, consisting of index-labeled pixels/voxels</p>
</div></blockquote>
<p><strong>include_labels</strong> : list of integers</p>
<blockquote>
<div><p>labels to include
(if empty, use unique numbers in image volume file)</p>
</div></blockquote>
<p><strong>exclude_labels</strong> : list of integers</p>
<blockquote>
<div><p>labels to be excluded</p>
</div></blockquote>
<p><strong>label_names</strong> : list of strings</p>
<blockquote>
<div><p>label names corresponding to labels to include</p>
</div></blockquote>
<p><strong>save_table</strong> : Boolean</p>
<blockquote>
<div><p>save output table file with labels and volume values?</p>
</div></blockquote>
<p><strong>output_table</strong> : string</p>
<blockquote>
<div><p>name of output table file with labels and volume values</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>unique_labels</strong> : list of integers</p>
<blockquote>
<div><p>unique label numbers (default -1)</p>
</div></blockquote>
<p><strong>volumes</strong> : list of floats</p>
<blockquote>
<div><p>volume for each label (default -1)</p>
</div></blockquote>
<p><strong>output_table</strong> : string</p>
<blockquote class="last">
<div><p>name of output volume table file (if output_table not empty)</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">os</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">mindboggle.mio.labels</span> <span class="kn">import</span> <span class="n">DKTprotocol</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">mindboggle.shapes.volume_shapes</span> <span class="kn">import</span> <span class="n">volume_per_brain_region</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">input_file</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s">&#39;HOME&#39;</span><span class="p">],</span> <span class="s">&#39;mindboggled&#39;</span><span class="p">,</span> <span class="s">&#39;Twins-2-1old&#39;</span><span class="p">,</span> <span class="s">&#39;labels&#39;</span><span class="p">,</span> <span class="s">&#39;ants_filled_labels.nii.gz&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dkt</span> <span class="o">=</span> <span class="n">DKTprotocol</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">include_labels</span> <span class="o">=</span> <span class="n">dkt</span><span class="o">.</span><span class="n">label_numbers</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">exclude_labels</span> <span class="o">=</span> <span class="p">[]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">label_names</span> <span class="o">=</span> <span class="n">dkt</span><span class="o">.</span><span class="n">label_names</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">save_table</span> <span class="o">=</span> <span class="bp">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">output_table</span> <span class="o">=</span> <span class="s">&#39;volumes.csv&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">unique_labels</span><span class="p">,</span> <span class="n">volumes</span><span class="p">,</span> <span class="n">output_table</span> <span class="o">=</span> <span class="n">volume_per_brain_region</span><span class="p">(</span><span class="n">input_file</span><span class="p">,</span> <span class="n">include_labels</span><span class="p">,</span> <span class="n">exclude_labels</span><span class="p">,</span> <span class="n">label_names</span><span class="p">,</span> <span class="n">save_table</span><span class="p">,</span> <span class="n">output_table</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">volumes</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</div>
</div>


          </div>
      </div>
      <div class="clearer"></div>
    </div>
<!-- Google Analytics -->
<script type="text/javascript">
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script>
<script type="text/javascript">
try {
var pageTracker = _gat._getTracker("UA-693862-13");
pageTracker._trackPageview();
} catch(err) {}
</script>

  </body>
</html>